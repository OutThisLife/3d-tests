(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{sfEl:function(e,t,n){"use strict";n.r(t),n.d(t,"TransformControls",function(){return i}),n.d(t,"TransformControlsGizmo",function(){return a}),n.d(t,"TransformControlsPlane",function(){return r});var o=n("Womt"),i=function(e,t){o.Object3D.call(this),t=void 0!==t?t:document,this.visible=!1;var n=new a;this.add(n);var i=new r;this.add(i);var s=this;F("camera",e),F("object",void 0),F("enabled",!0),F("axis",null),F("mode","translate"),F("translationSnap",null),F("rotationSnap",null),F("space","world"),F("size",1),F("dragging",!1),F("showX",!0),F("showY",!0),F("showZ",!0);var l={type:"change"},c={type:"mouseDown"},h={type:"mouseUp",mode:s.mode},p={type:"objectChange"},u=new o.Raycaster,d=new o.Vector3,m=new o.Vector3,w=new o.Quaternion,y={X:new o.Vector3(1,0,0),Y:new o.Vector3(0,1,0),Z:new o.Vector3(0,0,1)},v=new o.Vector3,f=new o.Vector3,M=new o.Vector3,b=new o.Vector3,x=new o.Vector3,g=new o.Vector3,P=0,X=new o.Vector3,Y=new o.Quaternion,Z=new o.Vector3,E=new o.Vector3,L=new o.Quaternion,B=new o.Quaternion,Q=new o.Vector3,I=new o.Vector3,S=new o.Quaternion,G=new o.Vector3,j=new o.Vector3,V=new o.Quaternion,z=new o.Quaternion,O=new o.Vector3,A=new o.Vector3,C=new o.Vector3,T=new o.Quaternion,k=new o.Vector3;function F(e,t){var o=t;Object.defineProperty(s,e,{get:function(){return void 0!==o?o:t},set:function(t){o!==t&&(o=t,i[e]=t,n[e]=t,s.dispatchEvent({type:e+"-changed",value:t}),s.dispatchEvent(l))}}),s[e]=t,i[e]=t,n[e]=t}function W(e){if(document.pointerLockElement)return{x:0,y:0,button:e.button};var n=e.changedTouches?e.changedTouches[0]:e,o=t.getBoundingClientRect();return{x:(n.clientX-o.left)/o.width*2-1,y:-(n.clientY-o.top)/o.height*2+1,button:e.button}}function q(e){s.enabled&&s.pointerHover(W(e))}function D(e){s.enabled&&(document.addEventListener("mousemove",R,!1),s.pointerHover(W(e)),s.pointerDown(W(e)))}function R(e){s.enabled&&s.pointerMove(W(e))}function _(e){s.enabled&&(document.removeEventListener("mousemove",R,!1),s.pointerUp(W(e)))}F("worldPosition",j),F("worldPositionStart",I),F("worldQuaternion",V),F("worldQuaternionStart",S),F("cameraPosition",X),F("cameraQuaternion",Y),F("pointStart",v),F("pointEnd",f),F("rotationAxis",b),F("rotationAngle",P),F("eye",A),t.addEventListener("mousedown",D,!1),t.addEventListener("touchstart",D,!1),t.addEventListener("mousemove",q,!1),t.addEventListener("touchmove",q,!1),t.addEventListener("touchmove",R,!1),document.addEventListener("mouseup",_,!1),t.addEventListener("touchend",_,!1),t.addEventListener("touchcancel",_,!1),t.addEventListener("touchleave",_,!1),this.dispose=function(){t.removeEventListener("mousedown",D),t.removeEventListener("touchstart",D),t.removeEventListener("mousemove",q),document.removeEventListener("mousemove",R),t.removeEventListener("touchmove",q),t.removeEventListener("touchmove",R),document.removeEventListener("mouseup",_),t.removeEventListener("touchend",_),t.removeEventListener("touchcancel",_),t.removeEventListener("touchleave",_),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(E,L,Q),this.object.matrixWorld.decompose(j,V,O),B.copy(L).inverse(),z.copy(V).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(X,Y,Z),A.copy(X).sub(j).normalize(),o.Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){u.setFromCamera(e,this.camera);var t=u.intersectObjects(n.picker[this.mode].children,!0)[0]||!1;this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)&&(0===e.button||void 0===e.button)&&null!==this.axis){u.setFromCamera(e,this.camera);var t=u.intersectObjects([i],!0)[0]||!1;if(t){var n=this.space;if("scale"===this.mode?n="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(n="world"),"local"===n&&"rotate"===this.mode){var o=this.rotationSnap;"X"===this.axis&&o&&(this.object.rotation.x=Math.round(this.object.rotation.x/o)*o),"Y"===this.axis&&o&&(this.object.rotation.y=Math.round(this.object.rotation.y/o)*o),"Z"===this.axis&&o&&(this.object.rotation.z=Math.round(this.object.rotation.z/o)*o)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),C.copy(this.object.position),T.copy(this.object.quaternion),k.copy(this.object.scale),this.object.matrixWorld.decompose(I,S,G),v.copy(t.point).sub(I)}this.dragging=!0,c.mode=this.mode,this.dispatchEvent(c)}},this.pointerMove=function(e){var t=this.axis,n=this.mode,o=this.object,a=this.space;if("scale"===n?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==o&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){u.setFromCamera(e,this.camera);var r=u.intersectObjects([i],!0)[0]||!1;if(!1!==r){if(f.copy(r.point).sub(I),"translate"===n)M.copy(f).sub(v),"local"===a&&"XYZ"!==t&&M.applyQuaternion(z),-1===t.indexOf("X")&&(M.x=0),-1===t.indexOf("Y")&&(M.y=0),-1===t.indexOf("Z")&&(M.z=0),"local"===a&&"XYZ"!==t?M.applyQuaternion(T).divide(Q):M.applyQuaternion(B).divide(Q),o.position.copy(M).add(C),this.translationSnap&&("local"===a&&(o.position.applyQuaternion(w.copy(T).inverse()),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(T)),"world"===a&&(o.parent&&o.position.add(d.setFromMatrixPosition(o.parent.matrixWorld)),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(d.setFromMatrixPosition(o.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var s=f.length()/v.length();f.dot(v)<0&&(s*=-1),m.set(s,s,s)}else d.copy(v),m.copy(f),d.applyQuaternion(z),m.applyQuaternion(z),m.divide(d),-1===t.search("X")&&(m.x=1),-1===t.search("Y")&&(m.y=1),-1===t.search("Z")&&(m.z=1);o.scale.copy(k).multiply(m)}else if("rotate"===n){M.copy(f).sub(v);var c=20/j.distanceTo(d.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(b.copy(A),P=f.angleTo(v),x.copy(v).normalize(),g.copy(f).normalize(),P*=g.cross(x).dot(A)<0?1:-1):"XYZE"===t?(b.copy(M).cross(A).normalize(),P=M.dot(d.copy(b).cross(this.eye))*c):"X"!==t&&"Y"!==t&&"Z"!==t||(b.copy(y[t]),d.copy(y[t]),"local"===a&&d.applyQuaternion(V),P=M.dot(d.cross(A).normalize())*c),this.rotationSnap&&(P=Math.round(P/this.rotationSnap)*this.rotationSnap),this.rotationAngle=P,"local"===a&&"E"!==t&&"XYZE"!==t?(o.quaternion.copy(T),o.quaternion.multiply(w.setFromAxisAngle(b,P)).normalize()):(b.applyQuaternion(B),o.quaternion.copy(w.setFromAxisAngle(b,P)),o.quaternion.multiply(T).normalize())}this.dispatchEvent(l),this.dispatchEvent(p)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(h.mode=this.mode,this.dispatchEvent(h)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return s.mode},this.setMode=function(e){s.mode=e},this.setTranslationSnap=function(e){s.translationSnap=e},this.setRotationSnap=function(e){s.rotationSnap=e},this.setSize=function(e){s.size=e},this.setSpace=function(e){s.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};i.prototype=Object.assign(Object.create(o.Object3D.prototype),{constructor:i,isTransformControls:!0});var a=function(){o.Object3D.call(this),this.type="TransformControlsGizmo";var e=new o.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:o.DoubleSide,fog:!1}),t=new o.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),n=e.clone();n.opacity=.15;var i=e.clone();i.opacity=.33;var a=e.clone();a.color.set(16711680);var r=e.clone();r.color.set(65280);var s=e.clone();s.color.set(255);var l=e.clone();l.opacity=.25;var c=l.clone();c.color.set(16776960);var h=l.clone();h.color.set(65535);var p=l.clone();p.color.set(16711935),e.clone().color.set(16776960);var u=t.clone();u.color.set(16711680);var d=t.clone();d.color.set(65280);var m=t.clone();m.color.set(255);var w=t.clone();w.color.set(65535);var y=t.clone();y.color.set(16711935);var v=t.clone();v.color.set(16776960);var f=t.clone();f.color.set(7895160);var M=v.clone();M.opacity=.25;var b=new o.CylinderBufferGeometry(0,.05,.2,12,1,!1),x=new o.BoxBufferGeometry(.125,.125,.125),g=new o.BufferGeometry;g.addAttribute("position",new o.Float32BufferAttribute([0,0,0,1,0,0],3));var P=function(e,t){for(var n=new o.BufferGeometry,i=[],a=0;a<=64*t;++a)i.push(0,Math.cos(a/32*Math.PI)*e,Math.sin(a/32*Math.PI)*e);return n.addAttribute("position",new o.Float32BufferAttribute(i,3)),n},X={X:[[new o.Mesh(b,a),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new o.Mesh(b,a),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new o.Line(g,u)]],Y:[[new o.Mesh(b,r),[0,1,0],null,null,"fwd"],[new o.Mesh(b,r),[0,1,0],[Math.PI,0,0],null,"bwd"],[new o.Line(g,d),null,[0,0,Math.PI/2]]],Z:[[new o.Mesh(b,s),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new o.Mesh(b,s),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new o.Line(g,m),null,[0,-Math.PI/2,0]]],XYZ:[[new o.Mesh(new o.OctahedronBufferGeometry(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new o.Mesh(new o.PlaneBufferGeometry(.295,.295),c.clone()),[.15,.15,0]],[new o.Line(g,v),[.18,.3,0],null,[.125,1,1]],[new o.Line(g,v),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new o.Mesh(new o.PlaneBufferGeometry(.295,.295),h.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new o.Line(g,w),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new o.Line(g,w),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new o.Mesh(new o.PlaneBufferGeometry(.295,.295),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new o.Line(g,y),[.18,0,.3],null,[.125,1,1]],[new o.Line(g,y),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},Y={X:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new o.Mesh(new o.OctahedronBufferGeometry(.2,0),n)]],XY:[[new o.Mesh(new o.PlaneBufferGeometry(.4,.4),n),[.2,.2,0]]],YZ:[[new o.Mesh(new o.PlaneBufferGeometry(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new o.Mesh(new o.PlaneBufferGeometry(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},Z={START:[[new o.Mesh(new o.OctahedronBufferGeometry(.01,2),i),null,null,null,"helper"]],END:[[new o.Mesh(new o.OctahedronBufferGeometry(.01,2),i),null,null,null,"helper"]],DELTA:[[new o.Line(function(){var e=new o.BufferGeometry;return e.addAttribute("position",new o.Float32BufferAttribute([0,0,0,1,1,1],3)),e}(),i),null,null,null,"helper"]],X:[[new o.Line(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new o.Line(g,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new o.Line(g,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},E={X:[[new o.Line(P(1,.5),u)],[new o.Mesh(new o.OctahedronBufferGeometry(.04,0),a),[0,0,.99],null,[1,3,1]]],Y:[[new o.Line(P(1,.5),d),null,[0,0,-Math.PI/2]],[new o.Mesh(new o.OctahedronBufferGeometry(.04,0),r),[0,0,.99],null,[3,1,1]]],Z:[[new o.Line(P(1,.5),m),null,[0,Math.PI/2,0]],[new o.Mesh(new o.OctahedronBufferGeometry(.04,0),s),[.99,0,0],null,[1,3,1]]],E:[[new o.Line(P(1.25,1),M),null,[0,Math.PI/2,0]],[new o.Mesh(new o.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new o.Mesh(new o.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new o.Mesh(new o.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new o.Mesh(new o.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new o.Line(P(1,1),f),null,[0,Math.PI/2,0]]]},L={AXIS:[[new o.Line(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},B={X:[[new o.Mesh(new o.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new o.Mesh(new o.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new o.Mesh(new o.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new o.Mesh(new o.TorusBufferGeometry(1.25,.1,2,24),n)]],XYZE:[[new o.Mesh(new o.SphereBufferGeometry(.7,10,8),n)]]},Q={X:[[new o.Mesh(x,a),[.8,0,0],[0,0,-Math.PI/2]],[new o.Line(g,u),null,null,[.8,1,1]]],Y:[[new o.Mesh(x,r),[0,.8,0]],[new o.Line(g,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new o.Mesh(x,s),[0,0,.8],[Math.PI/2,0,0]],[new o.Line(g,m),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new o.Mesh(x,c),[.85,.85,0],null,[2,2,.2]],[new o.Line(g,v),[.855,.98,0],null,[.125,1,1]],[new o.Line(g,v),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new o.Mesh(x,h),[0,.85,.85],null,[.2,2,2]],[new o.Line(g,w),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new o.Line(g,w),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new o.Mesh(x,p),[.85,0,.85],null,[2,.2,2]],[new o.Line(g,y),[.855,0,.98],null,[.125,1,1]],[new o.Line(g,y),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new o.Mesh(new o.BoxBufferGeometry(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new o.Mesh(new o.BoxBufferGeometry(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new o.Mesh(new o.BoxBufferGeometry(.125,.125,.125),l.clone()),[0,0,1.1]]]},I={X:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new o.Mesh(new o.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new o.Mesh(x,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new o.Mesh(x,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new o.Mesh(x,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new o.Mesh(new o.BoxBufferGeometry(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new o.Mesh(new o.BoxBufferGeometry(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new o.Mesh(new o.BoxBufferGeometry(.2,.2,.2),n),[0,0,1.1]]]},S={X:[[new o.Line(g,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new o.Line(g,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new o.Line(g,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},G=function(e){var t=new o.Object3D;for(var n in e)for(var i=e[n].length;i--;){var a=e[n][i][0].clone(),r=e[n][i][1],s=e[n][i][2],l=e[n][i][3],c=e[n][i][4];a.name=n,a.tag=c,r&&a.position.set(r[0],r[1],r[2]),s&&a.rotation.set(s[0],s[1],s[2]),l&&a.scale.set(l[0],l[1],l[2]),a.updateMatrix();var h=a.geometry.clone();h.applyMatrix(a.matrix),a.geometry=h,a.renderOrder=1/0,a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),t.add(a)}return t},j=new o.Vector3(0,0,0),V=new o.Euler,z=new o.Vector3(0,1,0),O=new o.Vector3(0,0,0),A=new o.Matrix4,C=new o.Quaternion,T=new o.Quaternion,k=new o.Quaternion,F=new o.Vector3(1,0,0),W=new o.Vector3(0,1,0),q=new o.Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=G(X)),this.add(this.gizmo.rotate=G(E)),this.add(this.gizmo.scale=G(Q)),this.add(this.picker.translate=G(Y)),this.add(this.picker.rotate=G(B)),this.add(this.picker.scale=G(I)),this.add(this.helper.translate=G(Z)),this.add(this.helper.rotate=G(L)),this.add(this.helper.scale=G(S)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:k;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var n=[];n=(n=(n=n.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var i=0;i<n.length;i++){var a=n[i];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition);var r=this.worldPosition.distanceTo(this.cameraPosition);if(a.scale.set(1,1,1).multiplyScalar(r*this.size/7),"helper"!==a.tag){if(a.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==a.name&&"XYZX"!==a.name||Math.abs(z.copy(F).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Y"!==a.name&&"XYZY"!==a.name||Math.abs(z.copy(W).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Z"!==a.name&&"XYZZ"!==a.name||Math.abs(z.copy(q).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XY"===a.name&&Math.abs(z.copy(q).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"YZ"===a.name&&Math.abs(z.copy(F).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XZ"===a.name&&Math.abs(z.copy(W).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),-1!==a.name.search("X")&&(z.copy(F).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(z.copy(W).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(z.copy(q).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))}else"rotate"===this.mode&&(T.copy(t),z.copy(this.eye).applyQuaternion(C.copy(t).inverse()),-1!==a.name.search("E")&&a.quaternion.setFromRotationMatrix(A.lookAt(this.eye,O,W)),"X"===a.name&&(C.setFromAxisAngle(F,Math.atan2(-z.y,z.z)),C.multiplyQuaternions(T,C),a.quaternion.copy(C)),"Y"===a.name&&(C.setFromAxisAngle(W,Math.atan2(z.x,z.z)),C.multiplyQuaternions(T,C),a.quaternion.copy(C)),"Z"===a.name&&(C.setFromAxisAngle(q,Math.atan2(z.y,z.x)),C.multiplyQuaternions(T,C),a.quaternion.copy(C)));a.visible=a.visible&&(-1===a.name.indexOf("X")||this.showX),a.visible=a.visible&&(-1===a.name.indexOf("Y")||this.showY),a.visible=a.visible&&(-1===a.name.indexOf("Z")||this.showZ),a.visible=a.visible&&(-1===a.name.indexOf("E")||this.showX&&this.showY&&this.showZ),a.material._opacity=a.material._opacity||a.material.opacity,a.material._color=a.material._color||a.material.color.clone(),a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled?this.axis&&(a.name===this.axis?(a.material.opacity=1,a.material.color.lerp(new o.Color(1,1,1),.5)):this.axis.split("").some(function(e){return a.name===e})?(a.material.opacity=1,a.material.color.lerp(new o.Color(1,1,1),.5)):(a.material.opacity*=.25,a.material.color.lerp(new o.Color(1,1,1),.5))):(a.material.opacity*=.5,a.material.color.lerp(new o.Color(1,1,1),.5))}else a.visible=!1,"AXIS"===a.name?(a.position.copy(this.worldPositionStart),a.visible=!!this.axis,"X"===this.axis&&(C.setFromEuler(V.set(0,0,0)),a.quaternion.copy(t).multiply(C),Math.abs(z.copy(F).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Y"===this.axis&&(C.setFromEuler(V.set(0,0,Math.PI/2)),a.quaternion.copy(t).multiply(C),Math.abs(z.copy(W).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Z"===this.axis&&(C.setFromEuler(V.set(0,Math.PI/2,0)),a.quaternion.copy(t).multiply(C),Math.abs(z.copy(q).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"XYZE"===this.axis&&(C.setFromEuler(V.set(0,Math.PI/2,0)),z.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(A.lookAt(O,z,W)),a.quaternion.multiply(C),a.visible=this.dragging),"E"===this.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):"END"===a.name?(a.position.copy(this.worldPosition),a.visible=this.dragging):"DELTA"===a.name?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),j.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),j.applyQuaternion(this.worldQuaternionStart.clone().inverse()),a.scale.copy(j),a.visible=this.dragging):(a.quaternion.copy(t),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=-1!==this.axis.search(a.name)))}o.Object3D.prototype.updateMatrixWorld.call(this)}};a.prototype=Object.assign(Object.create(o.Object3D.prototype),{constructor:a,isTransformControlsGizmo:!0});var r=function(){o.Mesh.call(this,new o.PlaneBufferGeometry(1e5,1e5,2,2),new o.MeshBasicMaterial({visible:!1,wireframe:!0,side:o.DoubleSide,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new o.Vector3(1,0,0),t=new o.Vector3(0,1,0),n=new o.Vector3(0,0,1),i=new o.Vector3,a=new o.Vector3,r=new o.Vector3,s=new o.Matrix4,l=new o.Quaternion;this.updateMatrixWorld=function(){var c=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(c="local"),e.set(1,0,0).applyQuaternion("local"===c?this.worldQuaternion:l),t.set(0,1,0).applyQuaternion("local"===c?this.worldQuaternion:l),n.set(0,0,1).applyQuaternion("local"===c?this.worldQuaternion:l),r.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":r.copy(this.eye).cross(e),a.copy(e).cross(r);break;case"Y":r.copy(this.eye).cross(t),a.copy(t).cross(r);break;case"Z":r.copy(this.eye).cross(n),a.copy(n).cross(r);break;case"XY":a.copy(n);break;case"YZ":a.copy(e);break;case"XZ":r.copy(n),a.copy(t);break;case"XYZ":case"E":a.set(0,0,0)}break;case"rotate":default:a.set(0,0,0)}0===a.length()?this.quaternion.copy(this.cameraQuaternion):(s.lookAt(i.set(0,0,0),a,r),this.quaternion.setFromRotationMatrix(s)),o.Object3D.prototype.updateMatrixWorld.call(this)}};r.prototype=Object.assign(Object.create(o.Mesh.prototype),{constructor:r,isTransformControlsPlane:!0})}}]);